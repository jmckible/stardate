<script type='text/javascript'>
  $(document).ready(function(){
    healthMonth = new Highcharts.Chart({
      chart: {
        renderTo: 'HealthMonth',
        width: 400,
        height: 280
      },
      title:  { text: false },
      legend: { enabled: false },
      yAxis:[
        {
          title: false
        }, 
        {
          title: false,
          opposite: true
        }
      ],
      xAxis: {
        type: 'datetime',
        tickInterval: 24 * 3600000,
        labels: {
          step: 7,
          formatter: function(){
            return(Highcharts.dateFormat('%b %e',this.value));
          }
        }
      },
      plotOptions:{
        spline:{
          marker: {
            enabled: false
          },
          shadow: false
        },
        column:{
          stacking: 'normal',
          shadow: false,
          pointWidth: 10,
          pointPadding: 0
        }
      },
      series: [{
        type: 'column',
        name: 'Bike',
        data: <%= @month.collect{|date|current_user.bikes.on(date).sum(:minutes)}.to_json %>,
        pointInterval: 24 * 3600000,
        pointStart: Date.UTC(<%= (@month.first - 1.month).year %>, <%= (@month.first - 1.month).month %>, <%= (@month.first - 1.month).day %>),
        yAxis: 0,
        color: '#0CF'
      },{
        type: 'column',
        name: 'Elliptical',
        data: <%= @month.collect{|date|current_user.ellipticals.on(date).sum(:minutes)}.to_json %>,
        pointInterval: 24 * 3600000,
        pointStart: Date.UTC(<%= (@month.first - 1.month).year %>, <%= (@month.first - 1.month).month %>, <%= (@month.first - 1.month).day %>),
        yAxis: 0,
        color: '#FC0'
      },{
        type: 'column',
        name: 'Run',
        data: <%= @month.collect{|date|current_user.runs.on(date).sum(:minutes)}.to_json %>,
        pointInterval: 24 * 3600000,
        pointStart: Date.UTC(<%= (@month.first - 1.month).year %>, <%= (@month.first - 1.month).month %>, <%= (@month.first - 1.month).day %>),
        yAxis: 0,
        color: '#F0F'
      },{
        type: 'column',
        name: 'Nike',
        data: <%= @month.collect{|date|current_user.nikes.on(date).sum(:minutes)}.to_json %>,
        pointInterval: 24 * 3600000,
        pointStart: Date.UTC(<%= (@month.first - 1.month).year %>, <%= (@month.first - 1.month).month %>, <%= (@month.first - 1.month).day %>),
        yAxis: 0,
        color: '#C00'
      } ,{
        type: 'column',
        name: 'P90X',
        data: <%= @month.collect{|date|current_user.p90xes.on(date).sum(:minutes)}.to_json %>,
        pointInterval: 24 * 3600000,
        pointStart: Date.UTC(<%= (@month.first - 1.month).year %>, <%= (@month.first - 1.month).month %>, <%= (@month.first - 1.month).day %>),
        yAxis: 0,
        color: '#C0C'
        },{
        type: 'spline',
        name: 'Weight',
        data: <%= current_user.weight_json @month %>,
        pointInterval: 24 * 3600000,
        pointStart: Date.UTC(<%= (@month.first - 1.month).year %>, <%= (@month.first - 1.month).month %>, <%= (@month.first - 1.month).day %>),
        yAxis: 1,
        lineWidth: 4
      }]
    });
  });
</script>